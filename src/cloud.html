<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            margin: 0px;
            padding: 0px;
        }
        @font-face {
            font-family: rwynumbers;
            src: url(font/ICAORWYID.ttf);
        }


    </style>
    <script>
        function setClouds() {
            console.log("test");
            let cloudInput = document.getElementById("cloudInput").value;
            let cloudArray = cloudInput.split(" ");
            let cloudsvg = document.getElementById("cloudsvg");
            let clouds = [];
            for (let i = 0; i < cloudArray.length; i += 3) {
                clouds.push({
                    type: cloudArray[i],
                    height: cloudArray[i + 1],
                    unit: cloudArray[i + 2]
                });
            }
            // if NSC is in the input, don't generate any clouds
            if (cloudArray.includes("NSC")) {
                clouds.push({
                    type: "NSC",
                    height: "No Significant Clouds",
                    unit: ""
                });
                return;
            }
            cloudsvg.innerHTML = "";
            clouds.sort((a, b) => {
                return a.height - b.height;
            });
            let rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
            rect.setAttribute("x", 0);
            rect.setAttribute("y", 0);
            rect.setAttribute("width", 600);
            rect.setAttribute("height", 600);
            rect.setAttribute("fill", "skyblue");
            cloudsvg.appendChild(rect);            

            for (let i = 0; i < clouds.length; i++) {
                let cloud = clouds[i];
                let y = 600 - (i + 1) * 100;
                let cloudCount = 0;
                if (cloud.type == "FEW") {
                    cloudCount = 2;
                } else if (cloud.type == "SCT") {
                    cloudCount = 4;
                } else if (cloud.type == "BKN") {
                    cloudCount = 7;
                } else if (cloud.type == "OVC") {
                    cloudCount = 8;
                }
                for (let j = 0; j < cloudCount; j++) {
                    let x = 150 + (((600-150)/cloudCount)*j);
                    let cloudGroup = document.createElementNS("http://www.w3.org/2000/svg", "g");
                    cloudGroup.setAttribute("transform", `translate(${x}, ${y})`);
                    cloudsvg.appendChild(cloudGroup);
                    for (let k = 0; k < 20; k++) {
                        let circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                        let cx = Math.random() * 40 - 10;
                        let cy = Math.random() * 20 - 10;
                        let r = Math.random() * 20 + 5;
                        let opacity = Math.random() * 0.5 + 0.5;
                        circle.setAttribute("cx", cx);
                        circle.setAttribute("cy", cy);
                        circle.setAttribute("r", r);
                        circle.setAttribute("fill", "white");
                        circle.setAttribute("fill-opacity", opacity);
                        cloudGroup.appendChild(circle);
                    }
                }
                for (let i = 0; i < clouds.length; i++) {
                let cloud = clouds[i];
                let y = 600 - (i + 1) * 100;
                let line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", 0);
                line.setAttribute("y1", y);
                line.setAttribute("x2", 600);
                line.setAttribute("y2", y);
                line.setAttribute("stroke", "white");
                line.setAttribute("stroke-width", 2);
                line.setAttribute("stroke-dasharray", "10, 10");
                cloudsvg.appendChild(line);

                let text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                text.setAttribute("x", 10);
                text.setAttribute("y", y - 10);
                text.setAttribute("fill", "black");
                text.textContent = cloud.type + " " + cloud.height + " " + cloud.unit;
                cloudsvg.appendChild(text);
            }
            }

        }

        document.onload = function() {
            document.getElementById("thing").addEventListener("submit", function(event) {
                event.preventDefault();
                setClouds();
            });
        }
    </script>

</head>
<body>
    <div class="cloudsvg">
        <svg width="600" height="600" viewbox="0 0 600 600" id="cloudsvg">
            <rect x="0" y="0" width="600" height="600" fill="skyblue"></rect>
            

        </svg>
    </div>
    <input type="text" id="cloudInput" placeholder="Enter Clouds"></input>
    <button onclick="setClouds()">Set Clouds</button>
</body>
</html>